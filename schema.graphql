enum Token {
  DAI
  USDC
}

enum ZToken {
  zDAI
  zUSDC
}

enum LendingPoolAction {
  Deposit
  Repay
  Withdraw
  Liquidate
}

enum EthEvent {
  LoanCreated
  TokenDeposited
  TokenWithdrawn
  TokenRepaid
  PaymentLiquidated
  SignerAdded
  SignerRemoved
  CollateralWithdrawn
  CollateralDeposited
  InterestSubmitted
  InterestAccepted
  AccruedInterestUpdated
  AccruedInterestWithdrawn
  InterestUpdateRequested
  CancelInterestUpdate
  ZTokenTransfer
  ZTokenApproval
  ZTokenMinterAdded
  ZTokenMinterRemoved
}

enum InterestUpdateStatusAction {
  Requested
  Canceled
}

enum AccruedInterestStatusAction {
  Withdrawn
  Updated
}

enum ZTokenStatusAction {
  Transfer
  Approval
  MinterAdded
  MinterRemoved
}

type EthTransaction @entity {
  id: ID!
  event: EthEvent!
  from: Bytes!
  gasPrice: BigInt!
  gasSent: BigInt!
  hash: Bytes!
  index: BigInt!
  to: Bytes!
  value: BigInt!
  contract: Bytes!
  timestamp: BigInt!
  gasLimit: BigInt!
  blockNumber: BigInt!
}

type Borrower @entity {
  id: ID!
  address: Bytes!
  loans: [Loan!]! @relation
}

type Loan @entity {
  id: ID!
  transaction: EthTransaction!
  borrower: Borrower!
  startDate: BigInt! # https://github.com/graphql/graphql-js/issues/1003#issuecomment-324790647
  interestRate: BigInt!
  collateralRatio: BigInt! 
  maxLoanAmount: BigInt!
  numberDays: BigInt!
  amountBorrow: BigInt!
  collateralDeposits: [CollateralDeposit!]!
  collateralWithdrawns: [CollateralWithdraw!]!
  blockNumber: BigInt!
  timestamp: BigInt!
}

type CollateralDeposit @entity {
  id: ID!
  transaction: EthTransaction!
  loan: Loan!
  borrower: Borrower!
  amount: BigInt!
  blockNumber: BigInt!
  timestamp: BigInt!
}

type CollateralWithdraw @entity {
  id: ID!
  transaction: EthTransaction!
  loan: Loan!
  borrower: Borrower!
  amount: BigInt!
  blockNumber: BigInt!
  timestamp: BigInt!
}

type Signer @entity {
  id: ID!
  address: Bytes!
  active: Boolean!
}

type LendingPoolStatus @entity {
  id: ID!
  zToken: ZToken!
  lendingToken: Token!
  transaction: EthTransaction!
  address: Bytes!
  amount: BigInt!
  action: LendingPoolAction!
  blockNumber: BigInt!
  timestamp: BigInt!
}

type InterestSubmitted @entity {
  id: ID!
  transaction: EthTransaction!
  signer: Bytes!
  lender: Bytes!
  blockNumber: BigInt!
  interest: BigInt!
  timestamp: BigInt!
}

type InterestAccepted @entity {
  id: ID!
  transaction: EthTransaction!
  lender: Bytes!
  blockNumber: BigInt!
  interest: BigInt!
  acceptedAt: BigInt!
}

type AccruedInterestStatus @entity {
  id: ID!
  transaction: EthTransaction!
  lender: Bytes!
  totalAmount: BigInt!
  accruedInterest: BigInt!
  action: AccruedInterestStatusAction!
  blockNumber: BigInt!
  timestamp: BigInt!
}

type InterestUpdateStatus @entity {
  id: ID!
  transaction: EthTransaction!
  lender: Bytes!
  blockNumber: BigInt!
  updatedAt: BigInt!
  action: InterestUpdateStatusAction!
}

type ZTokenBalance @entity {
  id: ID!
  amount: BigInt!
  zToken: ZToken!
  account: Bytes!
  blockNumber: BigInt!
  updatedAt: BigInt!
}

type ZTokenStatus @entity {
  id: ID!
  transaction: EthTransaction!
  amount: BigInt!
  zToken: ZToken!
  from: Bytes!
  to: Bytes!
  action: ZTokenStatusAction!
  blockNumber: BigInt!
  timestamp: BigInt!
}
